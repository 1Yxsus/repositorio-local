Esta es una nueva version 4 versiÃ³n del codigo.