Esta es una nueva versiÃ³n del codigo.